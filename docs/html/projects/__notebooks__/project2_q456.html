<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Jupyter Notebook for Transport Correction Factors &#8212; NRE7203 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="NRE7203: Advanced Reactor Physics" href="project2_workshop_spherical_harmonics.html" />
    <link rel="prev" title="A simple notebook for validating Simpson’s rule for a simple polynomial" href="project2_simpsons_test_notebook.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="jupyter-notebook-for-transport-correction-factors">
<span id="proj2-results-transport"></span><h1>Jupyter Notebook for Transport Correction Factors<a class="headerlink" href="#jupyter-notebook-for-transport-correction-factors" title="Link to this heading">¶</a></h1>
<section id="questions-4-6">
<h2>Questions 4 - 6<a class="headerlink" href="#questions-4-6" title="Link to this heading">¶</a></h2>
<section id="question-4-transport-correction-factors">
<h3>Question 4 - Transport Correction Factors<a class="headerlink" href="#question-4-transport-correction-factors" title="Link to this heading">¶</a></h3>
<p>Solve for the transport correction factors in H-1 using a typical
fission spectrum and a point source at 19 MeV</p>
<p>First do some imports</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">transportcorrection</span><span class="w"> </span><span class="kn">import</span> <span class="n">energyInterpolation</span><span class="p">,</span> <span class="n">Plot1d</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transportcorrection</span><span class="w"> </span><span class="kn">import</span> <span class="n">infFluxSolver</span><span class="p">,</span> <span class="n">TRCSolver</span><span class="p">,</span> <span class="n">plot_matrix</span><span class="p">,</span> <span class="n">solveFluxAndTRC</span>

<span class="c1"># Plot settings</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1"># Set default figure size</span>
</pre></div>
</div>
<p>Setup the source and then pass all the data into solveFluxAndTRC()</p>
<p>This function first solves for the flux, then it passes the flux into
another function to solve for the Transport correction ratio</p>
<p>2x plots are generated - the first is the matrix used to solve for the
flux - we can analyze how dense it is and its shape.</p>
<p>For H-1, scattering is possible for all energies above E - the matrix
should therefore be fully upper triangular.</p>
<p>However, for H-2, scattering will depend on the value of <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<p>$ :raw-latex:<a href="#id1"><span class="problematic" id="id2">`</span></a>alpha <a href="#id3"><span class="problematic" id="id4">`</span></a>E’ &lt; E &lt; E’$</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Watt fission spectrum source</span>
<span class="n">dataFile</span> <span class="o">=</span> <span class="s2">&quot;./database/H1.csv&quot;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataFile</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">energy</span><span class="o">/</span><span class="mf">9.880E+05</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">((</span><span class="mf">2.249E-06</span><span class="o">*</span><span class="n">energy</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">src</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Now solve using the below settings:</span>
<span class="n">energy1</span><span class="p">,</span><span class="n">tau_CHI</span><span class="p">,</span><span class="n">tau0</span><span class="p">,</span><span class="n">flx</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="n">dataFile</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.3350539207458496</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.3354883</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.2996173</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.6351154</span> <span class="n">s</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_6_1.png" src="../../_images/hw2_q456_6_1.png" />
<img alt="../../_images/hw2_q456_6_2.png" src="../../_images/hw2_q456_6_2.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Point source</span>
<span class="n">dataFile</span> <span class="o">=</span> <span class="s2">&quot;./database/H1.csv&quot;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataFile</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">energy</span><span class="o">/</span><span class="mf">9.880E+05</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">((</span><span class="mf">2.249E-06</span><span class="o">*</span><span class="n">energy</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">src</span> <span class="o">*=</span> <span class="mf">0.0</span>
<span class="n">src</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">src</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Now solve using the below settings:</span>
<span class="n">energy1</span><span class="p">,</span><span class="n">tau_POINT</span><span class="p">,</span><span class="n">tau0</span><span class="p">,</span><span class="n">flx</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="n">dataFile</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.48505210876464844</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.4855015</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.4006200</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.8861315</span> <span class="n">s</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_7_1.png" src="../../_images/hw2_q456_7_1.png" />
<img alt="../../_images/hw2_q456_7_2.png" src="../../_images/hw2_q456_7_2.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot both</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energy1</span><span class="p">,</span> <span class="n">tau_CHI</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;TCR(E) (fission spectrum)&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energy1</span><span class="p">,</span> <span class="n">tau_POINT</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;TCR(E) (19 MeV source)&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energy1</span><span class="p">,</span> <span class="n">tau0</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;--r&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;1/3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;results/tcr_H1_q4.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_8_0.png" src="../../_images/hw2_q456_8_0.png" />
</section>
<section id="question-5-h2-implementation">
<h3>Question 5 - H2 implementation<a class="headerlink" href="#question-5-h2-implementation" title="Link to this heading">¶</a></h3>
<p>Now we do the same as above but for H-2. Note the matrix is now much
different. The TCR is also plotted.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Watt fission spectrum source</span>
<span class="n">dataFile</span> <span class="o">=</span> <span class="s2">&quot;./database/H2.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataFile</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">energy</span><span class="o">/</span><span class="mf">9.880E+05</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">((</span><span class="mf">2.249E-06</span><span class="o">*</span><span class="n">energy</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">src</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Now solve using the below settings:</span>
<span class="n">energy1</span><span class="p">,</span><span class="n">tau_CHI</span><span class="p">,</span><span class="n">tau0</span><span class="p">,</span><span class="n">flx</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="n">dataFile</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/H2_q5.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.2839996814727783</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.2844796</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.3277695</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.6122637</span> <span class="n">s</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_11_1.png" src="../../_images/hw2_q456_11_1.png" />
<img alt="../../_images/hw2_q456_11_2.png" src="../../_images/hw2_q456_11_2.png" />
<section id="the-cross-sections-are-now-plotted">
<h4>The cross sections are now plotted:<a class="headerlink" href="#the-cross-sections-are-now-plotted" title="Link to this heading">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get xs for plotting</span>
<span class="n">dataFile</span> <span class="o">=</span> <span class="s2">&quot;./database/H2.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataFile</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
<span class="n">scattering</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;scattering&#39;</span><span class="p">])</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">])</span>
<span class="c1">#  Plot</span>

<span class="n">Plot1d</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$\Sigma(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;$\Sigma_t(E)$&quot;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">scattering</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$\Sigma(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;$\Sigma_s(E)$&quot;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">total</span><span class="o">-</span><span class="n">scattering</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$\Sigma(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;$\Sigma_a(E)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/XS_q5.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">&lt;&gt;:9: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:9: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:10: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:10: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:11: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:11: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:9: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:9: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:10: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:10: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:11: SyntaxWarning: invalid escape sequence 'S'
&lt;&gt;:11: SyntaxWarning: invalid escape sequence 'S'
/tmp/ipykernel_2144650/4054233365.py:9: SyntaxWarning: invalid escape sequence 'S'
  Plot1d(energy, total, xlabel=&quot;Energy, eV&quot;, ylabel=&quot;$Sigma(E)$&quot;, fontsize=15, marker=&quot;k-&quot;, markerfill=False, markersize=3, legend=&quot;$Sigma_t(E)$&quot;)
/tmp/ipykernel_2144650/4054233365.py:9: SyntaxWarning: invalid escape sequence 'S'
  Plot1d(energy, total, xlabel=&quot;Energy, eV&quot;, ylabel=&quot;$Sigma(E)$&quot;, fontsize=15, marker=&quot;k-&quot;, markerfill=False, markersize=3, legend=&quot;$Sigma_t(E)$&quot;)
/tmp/ipykernel_2144650/4054233365.py:10: SyntaxWarning: invalid escape sequence 'S'
  Plot1d(energy, scattering, xlabel=&quot;Energy, eV&quot;, ylabel=&quot;$Sigma(E)$&quot;, fontsize=15, marker=&quot;r--&quot;, markerfill=False, markersize=3, legend=&quot;$Sigma_s(E)$&quot;)
/tmp/ipykernel_2144650/4054233365.py:10: SyntaxWarning: invalid escape sequence 'S'
  Plot1d(energy, scattering, xlabel=&quot;Energy, eV&quot;, ylabel=&quot;$Sigma(E)$&quot;, fontsize=15, marker=&quot;r--&quot;, markerfill=False, markersize=3, legend=&quot;$Sigma_s(E)$&quot;)
/tmp/ipykernel_2144650/4054233365.py:11: SyntaxWarning: invalid escape sequence 'S'
  Plot1d(energy, total-scattering, xlabel=&quot;Energy, eV&quot;, ylabel=&quot;$Sigma(E)$&quot;, fontsize=15, marker=&quot;k--&quot;, markerfill=False, markersize=3, legend=&quot;$Sigma_a(E)$&quot;)
/tmp/ipykernel_2144650/4054233365.py:11: SyntaxWarning: invalid escape sequence 'S'
  Plot1d(energy, total-scattering, xlabel=&quot;Energy, eV&quot;, ylabel=&quot;$Sigma(E)$&quot;, fontsize=15, marker=&quot;k--&quot;, markerfill=False, markersize=3, legend=&quot;$Sigma_a(E)$&quot;)</pre>
<img alt="../../_images/hw2_q456_13_1.png" src="../../_images/hw2_q456_13_1.png" />
</section>
</section>
<section id="q6-simpsons-rule">
<h3>Q6 Simpsons Rule<a class="headerlink" href="#q6-simpsons-rule" title="Link to this heading">¶</a></h3>
<p>First we run _test_numerical_integration() to integrate the following
polynomial using both trapezoid and simpsons rule’s for integration.</p>
<p><span class="math notranslate nohighlight">\(f(x) = x^3 +5x^2 -2.125x - 1.1521\)</span></p>
<p>And the exact result is:</p>
<p><span class="math notranslate nohighlight">\(\int_{-10}^{10}f(x)dx = 3310.291333333333\)</span></p>
<p>Since Simpson’s rule integrates polynomials of up to and including
degree three exactly, then we should get exact results when using
Simpson’s rule here</p>
<p>Simpsons rule requires an even number of ‘bins’ but can be used with an
odd number of bins which we have also implemented - when using an odd
number of bins integration will be ‘close’ but not exact - whereas an
even number of bins will provide the exact result</p>
<section id="see-composite-simpsons-rule-for-irregularly-spaced-data">
<h4>See: Composite Simpson’s rule for irregularly spaced data<a class="headerlink" href="#see-composite-simpsons-rule-for-irregularly-spaced-data" title="Link to this heading">¶</a></h4>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Simpson%27s_rule">https://en.wikipedia.org/wiki/Simpson%27s_rule</a></p>
<p>We can run the below cell to run a variety of integration tests to
observe the accuracy of the two implemented integration schemes</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First we test the implemented numerical integration</span>
<span class="c1"># functions to prove to ourselves that our methods</span>
<span class="c1"># are not gibberish since latest code update</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transportcorrection</span><span class="w"> </span><span class="kn">import</span> <span class="n">_test_numerical_integration</span>
<span class="n">_test_numerical_integration</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Now</span> <span class="n">running</span> <span class="n">numerical</span> <span class="n">integration</span> <span class="k">for</span> <span class="n">various</span> <span class="n">settings</span> <span class="o">...</span>
<span class="n">Simpsons</span> <span class="n">rule</span> <span class="k">with</span> <span class="n">even</span> <span class="n">N</span> <span class="n">should</span> <span class="n">be</span> <span class="n">exact</span> <span class="n">since</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">of</span> <span class="n">low</span> <span class="n">enough</span> <span class="n">polynomial</span> <span class="n">order</span><span class="o">.</span>
<span class="n">Exact</span><span class="p">:</span> <span class="mf">3310.291333333333</span>
<span class="n">Simpsons</span> <span class="n">Rule</span> <span class="n">Odd</span> <span class="n">N</span><span class="p">:</span> <span class="mf">3316.387964944368</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.00010156631469726562</span>
<span class="n">Simpsons</span> <span class="n">Rule</span> <span class="n">Even</span> <span class="n">N</span><span class="p">:</span> <span class="mf">3310.291333333333</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.5789947509765625e-05</span>
<span class="n">Trapezoid</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">:</span> <span class="mf">3376.9579999999996</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.0067901611328125e-05</span>
<span class="n">Trapezoid</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">:</span> <span class="mf">3326.958</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">4.8160552978515625e-05</span>
<span class="n">Trapezoid</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">30</span><span class="p">:</span> <span class="mf">3317.6987407407405</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">4.9591064453125e-05</span>
<span class="n">Trapezoid</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">40</span><span class="p">:</span> <span class="mf">3314.4579999999996</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.507469177246094e-05</span>
<span class="n">Trapezoid</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">50</span><span class="p">:</span> <span class="mf">3312.9579999999996</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.1021575927734375e-05</span>
<span class="n">Trapezoid</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">:</span> <span class="mf">3310.2980133533592</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.0008146762847900391</span>
<span class="n">Trapezoid</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">3000</span><span class="p">:</span> <span class="mf">3310.292074568148</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.00018477439880371094</span>
<span class="n">Simpsons</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">3000</span><span class="p">:</span> <span class="mf">3310.2913333333336</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.0015516281127929688</span>
<span class="n">Simpsons</span> <span class="n">Rule</span> <span class="n">N</span><span class="o">=</span><span class="mi">2999</span><span class="p">:</span> <span class="mf">3310.2913333338333</span> <span class="o">|</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.0015654563903808594</span>
</pre></div>
</div>
</section>
<section id="now-running-a-bunch-of-different-calculations-to-compare-accuracy-time">
<h4>Now running a bunch of different calculations to compare accuracy/time.<a class="headerlink" href="#now-running-a-bunch-of-different-calculations-to-compare-accuracy-time" title="Link to this heading">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we run both trapezoid and simpsons rule for a variety of N values - 25,50,100,300</span>
<span class="c1"># We can compare the accuracy and runtimes of each.</span>

<span class="c1"># Watt fission spectrum source</span>
<span class="n">dataFile</span> <span class="o">=</span> <span class="s2">&quot;./database/H1.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataFile</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">energy</span><span class="o">/</span><span class="mf">9.880E+05</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">((</span><span class="mf">2.249E-06</span><span class="o">*</span><span class="n">energy</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">src</span> <span class="o">/</span> <span class="n">src</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># SIMPSONS INTEGRATION RULE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=25&quot;</span><span class="p">)</span>
<span class="n">energyS_25</span><span class="p">,</span> <span class="n">tauS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=50&quot;</span><span class="p">)</span>
<span class="n">energyS_50</span><span class="p">,</span> <span class="n">tauS_50</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=100&quot;</span><span class="p">)</span>
<span class="n">energyS_100</span><span class="p">,</span> <span class="n">tauS_100</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=300&quot;</span><span class="p">)</span>
<span class="n">energyS_300</span><span class="p">,</span> <span class="n">tauS_300</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">301</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=1000&quot;</span><span class="p">)</span>
<span class="n">energyS_1000</span><span class="p">,</span> <span class="n">tauS_1000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=3000&quot;</span><span class="p">)</span>
<span class="n">energyS_3000</span><span class="p">,</span> <span class="n">tauS_3000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">3001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=5000&quot;</span><span class="p">)</span>
<span class="n">energyS_5000</span><span class="p">,</span> <span class="n">tauS_5000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">5001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMPSONS N=10000&quot;</span><span class="p">)</span>
<span class="n">energyS_10000</span><span class="p">,</span> <span class="n">tauS_10000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">10001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>





<span class="c1"># TRAPEZOID INTEGRATION RULE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=25&quot;</span><span class="p">)</span>
<span class="n">energyT_25</span><span class="p">,</span> <span class="n">tauT_25</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=50&quot;</span><span class="p">)</span>
<span class="n">energyT_50</span><span class="p">,</span> <span class="n">tauT_50</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=100&quot;</span><span class="p">)</span>
<span class="n">energyT_100</span><span class="p">,</span> <span class="n">tauT_100</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=300&quot;</span><span class="p">)</span>
<span class="n">energyT_300</span><span class="p">,</span> <span class="n">tauT_300</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">301</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=1000&quot;</span><span class="p">)</span>
<span class="n">energyT_1000</span><span class="p">,</span> <span class="n">tauT_1000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=3000&quot;</span><span class="p">)</span>
<span class="n">energyT_3000</span><span class="p">,</span> <span class="n">tauT_3000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">3001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=5000&quot;</span><span class="p">)</span>
<span class="n">energyT_5000</span><span class="p">,</span> <span class="n">tauT_5000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">5001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAPEZOID N=10000&quot;</span><span class="p">)</span>
<span class="n">energyT_10000</span><span class="p">,</span> <span class="n">tauT_10000</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solveFluxAndTRC</span><span class="p">(</span><span class="n">dataPath</span><span class="o">=</span><span class="s2">&quot;./database/H1.csv&quot;</span><span class="p">,</span>
                <span class="n">isotopeMass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">energyN</span><span class="o">=</span><span class="mi">10001</span><span class="p">,</span>
                <span class="n">lowerE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">upperE</span><span class="o">=</span><span class="mf">19e6</span><span class="p">,</span>
                <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                <span class="n">rule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">,</span>
                <span class="n">plotFluxMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">plotTaus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">25</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.0003097057342529297</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0003352</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0004151</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0007551</span> <span class="n">s</span>
<span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">50</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.0007848739624023438</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0008056</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0009344</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0017433</span> <span class="n">s</span>
<span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.003744840621948242</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0037749</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0052822</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0090611</span> <span class="n">s</span>
<span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">300</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.0516057014465332</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0516844</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0488150</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.1005077</span> <span class="n">s</span>
<span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.2944059371948242</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.2949142</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.3197660</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.6147103</span> <span class="n">s</span>
<span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">3000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">2.4245777130126953</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">2.4249735</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">2.4539604</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">4.8789430</span> <span class="n">s</span>
<span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">5000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">7.581923484802246</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">7.5824642</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">7.3160963</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">14.8985806</span> <span class="n">s</span>
<span class="n">SIMPSONS</span> <span class="n">N</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">31.9954354763031</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">31.9959593</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">32.4131505</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">64.4091260</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">25</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.00023484230041503906</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0002649</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0003147</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0005846</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">50</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.0003452301025390625</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0003672</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0005801</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0009511</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.0011105537414550781</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0011399</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0013423</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0025089</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">300</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.004845142364501953</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0048769</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0065112</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0113921</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.030581951141357422</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0306883</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.0378132</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.0685101</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">3000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">0.3781712055206299</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.3785994</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">0.3330069</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.7116206</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">5000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">1.015740156173706</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">1.0167367</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">1.8223386</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">2.8391080</span> <span class="n">s</span>
<span class="n">TRAPEZOID</span> <span class="n">N</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">Time</span> <span class="n">to</span> <span class="n">solve</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">is</span> <span class="mf">7.815183401107788</span>
<span class="n">Flux</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">7.8157234</span> <span class="n">s</span>
<span class="n">Tau</span> <span class="n">calculation</span> <span class="n">took</span> <span class="mf">7.9559760</span> <span class="n">s</span>
<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">15.7717149</span> <span class="n">s</span>
</pre></div>
</div>
</section>
<section id="and-plotting-results">
<h4>And plotting results …<a class="headerlink" href="#and-plotting-results" title="Link to this heading">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_25</span><span class="p">,</span> <span class="n">tauT_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=25&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tauS_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=25&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/q6_25.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_21_0.png" src="../../_images/hw2_q456_21_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_50</span><span class="p">,</span> <span class="n">tauT_50</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=50&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_50</span><span class="p">,</span> <span class="n">tauS_50</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=50&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/q6_50.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_22_0.png" src="../../_images/hw2_q456_22_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_100</span><span class="p">,</span> <span class="n">tauT_100</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=100&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_100</span><span class="p">,</span> <span class="n">tauS_100</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=100&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/q6_100.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_23_0.png" src="../../_images/hw2_q456_23_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_300</span><span class="p">,</span> <span class="n">tauT_300</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=300&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_300</span><span class="p">,</span> <span class="n">tauS_300</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=300&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/q6_300.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_24_0.png" src="../../_images/hw2_q456_24_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_10000</span><span class="p">,</span> <span class="n">tauT_10000</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=300&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_10000</span><span class="p">,</span> <span class="n">tauS_10000</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=300&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/q6_10000.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_25_0.png" src="../../_images/hw2_q456_25_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting all the Trapezoid rules integrations</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># Set default figure size</span>

<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_25</span><span class="p">,</span> <span class="n">tauT_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=25&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_50</span><span class="p">,</span> <span class="n">tauT_50</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=50&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_100</span><span class="p">,</span> <span class="n">tauT_100</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;g-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=100&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_300</span><span class="p">,</span> <span class="n">tauT_300</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;m-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=300&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyT_10000</span><span class="p">,</span> <span class="n">tauT_10000</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Trap. N=10000&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/q6_trap.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_26_0.png" src="../../_images/hw2_q456_26_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting all the simpsons rules integrations</span>
<span class="c1"># Note that the last two points are integrated using trapezoid rule (since simpsons rule needs 3x datapoints)</span>
<span class="c1"># Thus there is a discontinuity</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># Set default figure size</span>

<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tauS_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;r-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=25&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_50</span><span class="p">,</span> <span class="n">tauS_50</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=50&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_100</span><span class="p">,</span> <span class="n">tauS_100</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;g-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=100&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_300</span><span class="p">,</span> <span class="n">tauS_300</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;m-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=300&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_10000</span><span class="p">,</span> <span class="n">tauS_10000</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Simp. N=10000&#39;</span><span class="p">)</span>
<span class="n">Plot1d</span><span class="p">(</span><span class="n">energyS_25</span><span class="p">,</span> <span class="n">tau0_25</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Energy, eV&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau(E)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">markerfill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./results/q6_simp.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_27_0.png" src="../../_images/hw2_q456_27_0.png" />
</section>
<section id="lets-observe-why-the-runtimes-are-so-different">
<h4>Lets observe why the runtimes are so different<a class="headerlink" href="#lets-observe-why-the-runtimes-are-so-different" title="Link to this heading">¶</a></h4>
<p>First compare the weight matrices (they look very similar for each
method)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">transportcorrection</span><span class="w"> </span><span class="kn">import</span> <span class="n">_scatteringWeightGrabber</span>
<span class="n">W_trap</span> <span class="o">=</span> <span class="n">_scatteringWeightGrabber</span><span class="p">(</span><span class="n">energy</span><span class="o">=</span><span class="n">energyT_10000</span><span class="p">,</span><span class="n">A</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">intRule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">)</span>
<span class="n">W_simp</span> <span class="o">=</span> <span class="n">_scatteringWeightGrabber</span><span class="p">(</span><span class="n">energy</span><span class="o">=</span><span class="n">energyT_10000</span><span class="p">,</span><span class="n">A</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">intRule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">)</span>
<span class="n">plot_matrix</span><span class="p">(</span><span class="n">W_trap</span><span class="p">,</span> <span class="n">black_white</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plot_matrix</span><span class="p">(</span><span class="n">W_simp</span><span class="p">,</span> <span class="n">black_white</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/hw2_q456_29_0.png" src="../../_images/hw2_q456_29_0.png" />
<img alt="../../_images/hw2_q456_29_1.png" src="../../_images/hw2_q456_29_1.png" />
</section>
<section id="then-compare-the-time-it-takes-to-assemble-the-matrices-this-is-the-likely-reason">
<h4>Then compare the time it takes to assemble the matrices (this is the likely reason….)<a class="headerlink" href="#then-compare-the-time-it-takes-to-assemble-the-matrices-this-is-the-likely-reason" title="Link to this heading">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">W_trap</span> <span class="o">=</span> <span class="n">_scatteringWeightGrabber</span><span class="p">(</span><span class="n">energy</span><span class="o">=</span><span class="n">energyS_10000</span><span class="p">,</span><span class="n">A</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">intRule</span><span class="o">=</span><span class="s1">&#39;trap&#39;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trapezoid rule scattering matrix assembly time =&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>


<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">W_simp</span> <span class="o">=</span> <span class="n">_scatteringWeightGrabber</span><span class="p">(</span><span class="n">energy</span><span class="o">=</span><span class="n">energyS_10000</span><span class="p">,</span><span class="n">A</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">intRule</span><span class="o">=</span><span class="s1">&#39;simp&#39;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simpsons rule scattering matrix assembly time =&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="mf">0.11665654182434082</span>
<span class="n">time</span> <span class="o">=</span> <span class="mf">23.96303963661194</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  


  <font size="4.99">
      Unique visitor count:
  </font>

  <!-- Add a visitor counter at the bottom of the sidebar -->
  <p style="margin-top: 2em; text-align: center;">
    <a href="https://www.hitwebcounter.com" target="_blank">
      <img src="https://hitwebcounter.com/counter/counter.php?page=20951669&style=0014&nbdigits=3&type=ip&initCount=0"
           title="Visitor counter"
           alt="counter"
           border="1">
    </a>
  </p>

<h1 class="logo"><a href="../../index.html">NRE7203</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Class Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Contributers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Projects</a><ul>
      <li>Previous: <a href="project2_simpsons_test_notebook.html" title="previous chapter">A simple notebook for validating Simpson’s rule for a simple polynomial</a></li>
      <li>Next: <a href="project2_workshop_spherical_harmonics.html" title="next chapter">NRE7203: Advanced Reactor Physics</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;July, 2025 Jonathon Faulkner.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/projects/__notebooks__/project2_q456.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>